
Sub Add_patient()
    Dim Pat As Cpatient 'Dim the class created in Cpatient class
    Dim Patients As New Collection 'Create a new collecion called patients
    Dim getSum As Double 'This is to get the avg age
    Dim avg, iatSum, avgIAT As Double
    Dim numCount As Integer
    Dim sumMale, sumFemale As Double

    Application.Volatile

    numCount = ThisWorkbook.Worksheets("Sheet1").Range("D3")
    Randomize

    Do
        Set Pat = New Cpatient 'Init this down here to be assignde rand
        Patients.Add Pat
        Pat.Iat = ExpRN(ThisWorkbook.Worksheets("Sheet1").Range("D4"))
        Pat.Name = "Test Name"
        i = rnd()
        Select Case i
            Case Is > 0.5
                Pat.Sex = " Male"
            Case Is <= 0.5
                Pat.Sex = " Female"
            End Select
        Pat.Age = WorksheetFunction.RandBetween(18, 101)

    Loop Until Patients.Count = numCount

    'Get the avg age
    For Each Pat In Patients
        getSum = getSum + Pat.Age
        iatSum = aitSum + Pat.Iat
        If Pat.Sex = " Male" Then
            sumMale = sumMale + 1
        Else
            sumFemale = sumFemale + 1
        End If
        'Debug.Print Pat.Iat
    Next Pat


    avgIAT = iatSum / Patients.Count
    avg = getSum / Patients.Count
    ThisWorkbook.Worksheets("Sheet1").Range("H3") = avg
    ThisWorkbook.Worksheets("Sheet1").Range("H4") = sumMale
    ThisWorkbook.Worksheets("Sheet1").Range("H5") = sumFemale
    ThisWorkbook.Worksheets("Sheet1").Range("H6") = avgIAT

End Sub
